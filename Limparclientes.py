{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 119,
   "id": "bc927b77-b3bc-4713-a664-d7b48516b10f",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Unnamed: 0</th>\n",
       "      <th>genero</th>\n",
       "      <th>idade</th>\n",
       "      <th>id</th>\n",
       "      <th>membro_desde</th>\n",
       "      <th>renda_anual</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>118</td>\n",
       "      <td>68be06ca386d4c31939f3a4f0e3dd783</td>\n",
       "      <td>20170212</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2</td>\n",
       "      <td>F</td>\n",
       "      <td>55</td>\n",
       "      <td>0610b486422d4921ae7d2bf64640c50b</td>\n",
       "      <td>20170715</td>\n",
       "      <td>112000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>3</td>\n",
       "      <td>NaN</td>\n",
       "      <td>118</td>\n",
       "      <td>38fe809add3b4fcf9315a9694bb96ff5</td>\n",
       "      <td>20180712</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>4</td>\n",
       "      <td>F</td>\n",
       "      <td>75</td>\n",
       "      <td>78afa995795e4d85b5d9ceeca43f5fef</td>\n",
       "      <td>20170509</td>\n",
       "      <td>100000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>5</td>\n",
       "      <td>NaN</td>\n",
       "      <td>118</td>\n",
       "      <td>a03223e636434f42ac4c3df47e8bac43</td>\n",
       "      <td>20170804</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16995</th>\n",
       "      <td>16996</td>\n",
       "      <td>F</td>\n",
       "      <td>45</td>\n",
       "      <td>6d5f3a774f3d4714ab0c092238f3a1d7</td>\n",
       "      <td>20180604</td>\n",
       "      <td>54000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16996</th>\n",
       "      <td>16997</td>\n",
       "      <td>M</td>\n",
       "      <td>61</td>\n",
       "      <td>2cb4f97358b841b9a9773a7aa05a9d77</td>\n",
       "      <td>20180713</td>\n",
       "      <td>72000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16997</th>\n",
       "      <td>16998</td>\n",
       "      <td>M</td>\n",
       "      <td>49</td>\n",
       "      <td>01d26f638c274aa0b965d24cefe3183f</td>\n",
       "      <td>20170126</td>\n",
       "      <td>73000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16998</th>\n",
       "      <td>16999</td>\n",
       "      <td>F</td>\n",
       "      <td>83</td>\n",
       "      <td>9dc1421481194dcd9400aec7c9ae6366</td>\n",
       "      <td>20160307</td>\n",
       "      <td>50000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16999</th>\n",
       "      <td>17000</td>\n",
       "      <td>F</td>\n",
       "      <td>62</td>\n",
       "      <td>e4052622e5ba45a8b96b59aba68cf068</td>\n",
       "      <td>20170722</td>\n",
       "      <td>82000.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>17000 rows × 6 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "       Unnamed: 0 genero  idade                                id  \\\n",
       "0               1    NaN    118  68be06ca386d4c31939f3a4f0e3dd783   \n",
       "1               2      F     55  0610b486422d4921ae7d2bf64640c50b   \n",
       "2               3    NaN    118  38fe809add3b4fcf9315a9694bb96ff5   \n",
       "3               4      F     75  78afa995795e4d85b5d9ceeca43f5fef   \n",
       "4               5    NaN    118  a03223e636434f42ac4c3df47e8bac43   \n",
       "...           ...    ...    ...                               ...   \n",
       "16995       16996      F     45  6d5f3a774f3d4714ab0c092238f3a1d7   \n",
       "16996       16997      M     61  2cb4f97358b841b9a9773a7aa05a9d77   \n",
       "16997       16998      M     49  01d26f638c274aa0b965d24cefe3183f   \n",
       "16998       16999      F     83  9dc1421481194dcd9400aec7c9ae6366   \n",
       "16999       17000      F     62  e4052622e5ba45a8b96b59aba68cf068   \n",
       "\n",
       "       membro_desde  renda_anual  \n",
       "0          20170212          NaN  \n",
       "1          20170715     112000.0  \n",
       "2          20180712          NaN  \n",
       "3          20170509     100000.0  \n",
       "4          20170804          NaN  \n",
       "...             ...          ...  \n",
       "16995      20180604      54000.0  \n",
       "16996      20180713      72000.0  \n",
       "16997      20170126      73000.0  \n",
       "16998      20160307      50000.0  \n",
       "16999      20170722      82000.0  \n",
       "\n",
       "[17000 rows x 6 columns]"
      ]
     },
     "execution_count": 119,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import pandas as pd \n",
    "\n",
    "clientesdados = pd.read_csv(\"Documents/dados/dados_clientes.csv\")\n",
    "\n",
    "clientesdados.drop_duplicates() #remover duplicatas\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 53,
   "id": "cb503c84-09e3-4698-9031-6820ec2e503d",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "genero\n",
       "M    10659\n",
       "F     6129\n",
       "O      212\n",
       "Name: count, dtype: int64"
      ]
     },
     "execution_count": 53,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "clientesdados[\"genero\"].value_counts() #como temos dados nulos, podemos tanto remover ou substituir pela moda.\n",
    "#vamos tratar pela moda"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 121,
   "id": "9cc408fe-f61c-4713-a1de-1a049d0f6705",
   "metadata": {},
   "outputs": [],
   "source": [
    "clientesdados.loc[clientesdados[\"genero\"].isnull(),\"genero\"] = \"M\" #tratamento de dados"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 123,
   "id": "4ccc2df1-f3d6-4e0a-85eb-486cb0c022bd",
   "metadata": {},
   "outputs": [],
   "source": [
    "filtrorenda=clientesdados #usar um filtro para seguranca"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 125,
   "id": "6c795c45-6622-40e4-bf91-f8bb67d415a3",
   "metadata": {},
   "outputs": [],
   "source": [
    "filtrorenda[\"renda_anual\"] = pd.to_numeric(filtrorenda[\"renda_anual\"],errors=\"coerce\") #converter para numerico"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 127,
   "id": "4ffae21c-5297-4cdd-abee-a585d56eabb8",
   "metadata": {},
   "outputs": [],
   "source": [
    "mediana = filtrorenda[\"renda_anual\"].mean() #mediana "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 129,
   "id": "ba642426-80c3-426a-879f-59cb5adc722e",
   "metadata": {},
   "outputs": [],
   "source": [
    "filtrorenda.loc[filtrorenda[\"renda_anual\"].isnull(),\"renda_anual\"]= mediana #vamos tratar os dados nulos para mediana"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 131,
   "id": "b8cd575b-e298-43d0-8a54-b6f2bfbb3d33",
   "metadata": {},
   "outputs": [],
   "source": [
    "filtrorenda[\"renda_anual\"]=filtrorenda[\"renda_anual\"].round(2) #formatar para melhorar a visibilidade"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 137,
   "id": "ebb684c4-60c6-496a-9b49-1292c32b0c3a",
   "metadata": {},
   "outputs": [],
   "source": [
    "clientesdados = filtrorenda #atribuimos os dados tratados"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 141,
   "id": "0257496f-1a0c-409c-8ae4-16cebeefce6a",
   "metadata": {},
   "outputs": [],
   "source": [
    "clientesdados[\"membro_desde\"] = pd.to_datetime(clientesdados[\"membro_desde\"], format=\"%Y%m%d\", errors=\"coerce\") #arrumamos a formatacao da coluna membro_desde para date\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 143,
   "id": "d0978524-da7d-4110-8e7c-80b92cce9fc3",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Unnamed: 0</th>\n",
       "      <th>genero</th>\n",
       "      <th>idade</th>\n",
       "      <th>id</th>\n",
       "      <th>membro_desde</th>\n",
       "      <th>renda_anual</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>M</td>\n",
       "      <td>118</td>\n",
       "      <td>68be06ca386d4c31939f3a4f0e3dd783</td>\n",
       "      <td>2017-02-12</td>\n",
       "      <td>65404.99</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2</td>\n",
       "      <td>F</td>\n",
       "      <td>55</td>\n",
       "      <td>0610b486422d4921ae7d2bf64640c50b</td>\n",
       "      <td>2017-07-15</td>\n",
       "      <td>112000.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>3</td>\n",
       "      <td>M</td>\n",
       "      <td>118</td>\n",
       "      <td>38fe809add3b4fcf9315a9694bb96ff5</td>\n",
       "      <td>2018-07-12</td>\n",
       "      <td>65404.99</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>4</td>\n",
       "      <td>F</td>\n",
       "      <td>75</td>\n",
       "      <td>78afa995795e4d85b5d9ceeca43f5fef</td>\n",
       "      <td>2017-05-09</td>\n",
       "      <td>100000.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>5</td>\n",
       "      <td>M</td>\n",
       "      <td>118</td>\n",
       "      <td>a03223e636434f42ac4c3df47e8bac43</td>\n",
       "      <td>2017-08-04</td>\n",
       "      <td>65404.99</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16995</th>\n",
       "      <td>16996</td>\n",
       "      <td>F</td>\n",
       "      <td>45</td>\n",
       "      <td>6d5f3a774f3d4714ab0c092238f3a1d7</td>\n",
       "      <td>2018-06-04</td>\n",
       "      <td>54000.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16996</th>\n",
       "      <td>16997</td>\n",
       "      <td>M</td>\n",
       "      <td>61</td>\n",
       "      <td>2cb4f97358b841b9a9773a7aa05a9d77</td>\n",
       "      <td>2018-07-13</td>\n",
       "      <td>72000.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16997</th>\n",
       "      <td>16998</td>\n",
       "      <td>M</td>\n",
       "      <td>49</td>\n",
       "      <td>01d26f638c274aa0b965d24cefe3183f</td>\n",
       "      <td>2017-01-26</td>\n",
       "      <td>73000.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16998</th>\n",
       "      <td>16999</td>\n",
       "      <td>F</td>\n",
       "      <td>83</td>\n",
       "      <td>9dc1421481194dcd9400aec7c9ae6366</td>\n",
       "      <td>2016-03-07</td>\n",
       "      <td>50000.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16999</th>\n",
       "      <td>17000</td>\n",
       "      <td>F</td>\n",
       "      <td>62</td>\n",
       "      <td>e4052622e5ba45a8b96b59aba68cf068</td>\n",
       "      <td>2017-07-22</td>\n",
       "      <td>82000.00</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>17000 rows × 6 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "       Unnamed: 0 genero  idade                                id  \\\n",
       "0               1      M    118  68be06ca386d4c31939f3a4f0e3dd783   \n",
       "1               2      F     55  0610b486422d4921ae7d2bf64640c50b   \n",
       "2               3      M    118  38fe809add3b4fcf9315a9694bb96ff5   \n",
       "3               4      F     75  78afa995795e4d85b5d9ceeca43f5fef   \n",
       "4               5      M    118  a03223e636434f42ac4c3df47e8bac43   \n",
       "...           ...    ...    ...                               ...   \n",
       "16995       16996      F     45  6d5f3a774f3d4714ab0c092238f3a1d7   \n",
       "16996       16997      M     61  2cb4f97358b841b9a9773a7aa05a9d77   \n",
       "16997       16998      M     49  01d26f638c274aa0b965d24cefe3183f   \n",
       "16998       16999      F     83  9dc1421481194dcd9400aec7c9ae6366   \n",
       "16999       17000      F     62  e4052622e5ba45a8b96b59aba68cf068   \n",
       "\n",
       "      membro_desde  renda_anual  \n",
       "0       2017-02-12     65404.99  \n",
       "1       2017-07-15    112000.00  \n",
       "2       2018-07-12     65404.99  \n",
       "3       2017-05-09    100000.00  \n",
       "4       2017-08-04     65404.99  \n",
       "...            ...          ...  \n",
       "16995   2018-06-04     54000.00  \n",
       "16996   2018-07-13     72000.00  \n",
       "16997   2017-01-26     73000.00  \n",
       "16998   2016-03-07     50000.00  \n",
       "16999   2017-07-22     82000.00  \n",
       "\n",
       "[17000 rows x 6 columns]"
      ]
     },
     "execution_count": 143,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7bab0e8b-0074-446a-b86c-d2b4f5a32297",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python [conda env:base] *",
   "language": "python",
   "name": "conda-base-py"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.12.7"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
